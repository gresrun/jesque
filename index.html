<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 2.0.0 at $dateFormat.format( $currentDate ) 
 | Rendered using Apache Maven Fluido Skin 1.6
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="" lang="">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="Content-Language" content="" />
    <title>Jesque â€“ Jesque</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.6.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
      <script type="text/javascript" src="./js/apache-maven-fluido-1.6.min.js"></script>
      </head>
    <body class="topBarDisabled">
                      <a href="https://github.com/gresrun/jesque">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"
        alt="Fork me on GitHub">
    </a>
      <div class="container-fluid">
      <div id="banner">
        <div class="pull-left">          <h1>Jesque
</h1></div>
        <div class="pull-right"></div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
        <li id="publishDate">$i18n.getString( "site-renderer", $locale, "template.lastpublished" ): $dateValue<span class="divider">|</span>
</li>
          <li id="projectVersion">$i18n.getString( "site-renderer", $locale, "template.version" ): 3.0.0</li>
        </ul>
      </div>
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
<ul class="nav nav-list">
          <li class="nav-header">Project Documentation</li>
    <li><a href="project-info.html" title="Project Information"><span class="icon-chevron-down"></span>Project Information</a>
      <ul class="nav nav-list">
    <li><a href="ci-management.html" title="CI Management"><span class="none"></span>CI Management</a>  </li>
    <li><a href="dependencies.html" title="Dependencies"><span class="none"></span>Dependencies</a>  </li>
    <li><a href="dependency-info.html" title="Maven Coordinates"><span class="none"></span>Maven Coordinates</a>  </li>
    <li><a href="distribution-management.html" title="Distribution Management"><span class="none"></span>Distribution Management</a>  </li>
    <li class="active"><a href="#"><span class="none"></span>About</a>
  </li>
    <li><a href="issue-management.html" title="Issue Management"><span class="none"></span>Issue Management</a>  </li>
    <li><a href="licenses.html" title="Licenses"><span class="none"></span>Licenses</a>  </li>
    <li><a href="plugin-management.html" title="Plugin Management"><span class="none"></span>Plugin Management</a>  </li>
    <li><a href="plugins.html" title="Plugins"><span class="none"></span>Plugins</a>  </li>
    <li><a href="scm.html" title="Source Code Management"><span class="none"></span>Source Code Management</a>  </li>
    <li><a href="summary.html" title="Summary"><span class="none"></span>Summary</a>  </li>
    <li><a href="team.html" title="Team"><span class="none"></span>Team</a>  </li>
      </ul>
  </li>
    <li><a href="project-reports.html" title="Project Reports"><span class="icon-chevron-right"></span>Project Reports</a>  </li>
  </ul>
          <hr />
          <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
  <a href="http://maven.apache.org/" title="$i18n.getString( "site-renderer", $locale, "template.builtby" ) Maven" class="poweredBy"><img class="builtBy" alt="$i18n.getString( "site-renderer", $locale, "template.builtby" ) Maven" src="./images/logos/maven-feather.png" /></a>
              </div>
          </div>
        </div>
        <div id="bodyColumn"  class="span10" >
<section><a id="Jesque"></a>
<h1>Jesque</h1>
<p><a href="https://actions-badge.atrox.dev/gresrun/jesque/goto?ref=master" class="externalLink"><img src="https://img.shields.io/endpoint.svg?url=https%3A%2F%2Factions-badge.atrox.dev%2Fgresrun%2Fjesque%2Fbadge%3Fref%3Dmaster&amp;style=flat&amp;label=build&amp;logo=none" alt="Build Status" /></a> <a href="https://codecov.io/gh/gresrun/jesque" class="externalLink"><img src="https://codecov.io/gh/gresrun/jesque/branch/master/graph/badge.svg?token=gbXcqIQTZD" alt="Coverage Status" /></a> <a href="https://github.com/gresrun/jesque/blob/master/LICENSE" class="externalLink"><img src="https://img.shields.io/badge/license-Apache%202.0-blue.svg" alt="License Apache 2.0" /></a> <a href="http://search.maven.org/#search%7Cgav%7C1%7Cg%3A%22net.greghaines%22%20AND%20a%3A%22jesque%22" class="externalLink"><img src="https://img.shields.io/maven-central/v/net.greghaines/jesque.svg" alt="Maven Central" /></a></p>
<p>Jesque is an implementation of <a href="https://github.com/resque/resque" class="externalLink">Resque</a> in <a href="https://www.java.com/" class="externalLink">Java</a>. It is fully-interoperable with the <a href="https://www.ruby-lang.org/" class="externalLink">Ruby</a> and <a href="https://nodejs.org/" class="externalLink">Node.js</a> (<a href="https://github.com/technoweenie/coffee-resque" class="externalLink">Coffee-Resque</a>) implementations.</p>
<p>Jesque is a <a href="http://maven.apache.org/" class="externalLink">Maven</a> project and depends on <a href="https://github.com/redis/jedis" class="externalLink">Jedis</a> to connect to <a href="https://redis.io/" class="externalLink">Redis</a>, <a href="https://github.com/FasterXML/jackson" class="externalLink">Jackson</a> to map to/from <a href="https://json.org/" class="externalLink">JSON</a> and <a href="https://slf4j.org/" class="externalLink">SLF4J</a> for logging.</p>
<p>The project contains a client implementation as well as a worker implementation that supports listeners.</p><hr /><section><a id="How_do_I_use_it.3F"></a>
<h2>How do I use it?</h2>
<p>Jesque requires Java 17+. Download the latest source at:</p>
<p><a href="https://github.com/gresrun/jesque" class="externalLink">https://github.com/gresrun/jesque</a></p>
<p>Or, to use it in your Maven project, add it as a dependency:</p>

<pre><code class="language-xml">&lt;dependency&gt;
  &lt;groupId&gt;net.greghaines&lt;/groupId&gt;
  &lt;artifactId&gt;jesque&lt;/artifactId&gt;
  &lt;version&gt;3.0.0&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
<p><em>NOTE:</em> If you are running Java 8 to Java 16, you can still use the 2.x versions, the latest of which is 2.3.0.</p><section><a id="Migrating_to_3.x"></a>
<h3>Migrating to 3.x</h3>
<p>Starting with version 3.0.0, Jesque now requires Java 17 and had been modernized to use the latest Jedis client (7.2.x) as well as the latest version of Jackson (3.x).</p>
<p>The Jedis client changes will require <a href="https://redis.github.io/jedis/migration-guides/v6-to-v7/" class="externalLink">minor refactoring</a> if you were constructing pooled connections manually. Jackson 3.x has a <a href="https://github.com/FasterXML/jackson/blob/main/jackson3/MIGRATING_TO_JACKSON_3.md" class="externalLink">comprehensive guide</a> to the changes to that library, notably the exception types and ObjectMapper class. Jesque itself has some minor breaking API changes, includng how <code>Config</code> objects are constructed and types of durations and future times.</p></section></section><section><a id="Quickstart"></a>
<h2>Quickstart</h2>

<pre><code class="language-java">// Configuration
var config = Config.newBuilder()
  .withHostAndPort(host, port)
  .withPassword(password)
  .build();

// Add a job to a queue
var job = new Job(&quot;TestAction&quot;,
  new Object[]{ 1, 2.3, true, &quot;test&quot;, List.of(&quot;inner&quot;, 4.5)});

var client = new ClientImpl(config);
client.enqueue(&quot;foo&quot;, job);
client.end();

// Start a worker to run jobs from that queue
var queues = List.of(&quot;foo&quot;);
var jobFactory =
  new MapBasedJobFactory(Map.of(&quot;TestAction&quot;, TestAction.class))
var worker = new WorkerImpl(config, queues, jobFactory);
  
var workerThread = new Thread(worker);
workerThread.start();

// Enqueue more jobs, etc.

// Shutdown the worker when finished
worker.end(true);
try {
  workerThread.join();
} catch (Exception e){
  e.printStackTrace();
}
</code></pre>
<p>If enqueueing multiple jobs at the same time, there is <code>client.batchEnqueue(String queue, List&lt;Job&gt; jobs)</code> which does it
in an optimized way.</p><section><a id="Delayed_jobs"></a>
<h3>Delayed jobs</h3>
<p>Delayed jobs can be executed at sometime in the future:</p>

<pre><code class="language-java">var future = Instant.now().plusSeconds(10L);

client.delayedEnqueue(&quot;fooDelay&quot;, job, future);
</code></pre>
<p><em>NOTE:</em> Jesque's delayed jobs implementation is not compatible with <a href="https://github.com/resque/resque-scheduler" class="externalLink">resque-scheduler</a>.</p></section><section><a id="Recurring_Jobs"></a>
<h3>Recurring Jobs</h3>
<p>Recurring jobs can start at a specific time and execute at specified intervals:</p>

<pre><code class="language-java">var future = Instant.now().plusSeconds(10L);
var frequency = Duration.ofSeconds(60L);

client.recurringEnqueue(&quot;fooRecur&quot;, job, future, frequency));
</code></pre></section><section><a id="Cancelling_jobs"></a>
<h3>Cancelling jobs</h3>
<p>Delayed and recurring jobs can be cancelled:</p>

<pre><code class="language-java">client.removeDelayedEnqueue(&quot;fooDelay&quot;, job);
client.removeRecurringEnqueue(&quot;fooRecur&quot;, job);
</code></pre></section><section><a id="Using_a_pooled_Client"></a>
<h3>Using a pooled Client</h3>
<p>Using a pool of client connections is useful in multi threaded apps:</p>

<pre><code class="language-java">var jesqueClientPool =
  new ClientPoolImpl(config, PoolUtils.createJedisPool(config));
jesqueClientPool.enqueue(&quot;foo&quot;, job);
</code></pre></section><section><a id="Listeners"></a>
<h3>Listeners</h3>
<p>You can execute custom callbacks during specific Worker events:</p>

<pre><code class="language-java">int myVar = 123;
worker.getWorkerEventEmitter().addListener(
  (event, worker, queue, job, runner, result, throwable) -&gt; {
    if (runner instanceof TestAction) {
      runner.setSomeVariable(myVar);
    }
  }, WorkerEvent.JOB_EXECUTE);
</code></pre><section><a id="Available_Worker_Events"></a>
<h4>Available Worker Events</h4>
<ul>

<li><code>WORKER_START</code> Finished starting up and is about to start running.</li>
<li><code>WORKER_POLL</code> Polling the queue.</li>
<li><code>JOB_PROCESS</code> Processing a Job.</li>
<li><code>JOB_EXECUTE</code> About to execute a materialized Job.</li>
<li><code>JOB_SUCCESS</code> Successfully executed a materialized Job.</li>
<li><code>JOB_FAILURE</code> Caught an Exception during the execution of a materialized Job.</li>
<li><code>WORKER_ERROR</code> Caught an Exception during normal operation.</li>
<li><code>WORKER_STOP</code> Finished running and is about to shutdown.</li>
</ul>
<p>For more usage examples check the tests. The tests require that Redis is running on <code>localhost:6379</code>.</p>
<p>Use the resque-web application to see the status of your jobs and workers or, if you prefer Java, try <a href="https://github.com/gresrun/jesque-web" class="externalLink">Jesque-Web</a>.</p></section></section><section><a id="Redis_Configuration"></a>
<h3>Redis Configuration</h3>
<p>As mentioned Jesque depends on <a href="https://github.com/redis/jedis" class="externalLink">Jedis</a> to connect to <a href="https://redis.io/" class="externalLink">Redis</a>.</p>
<p>You can configure Jesque to connect to Redis given a URL in a system property (as used in Heroku + RedisToGo) with the following snippet:</p>

<pre><code class="language-java">final Config.Builder configBuilder = Config.newBuilder();
try {
  var redisUrl = new URI(System.getProperty(&quot;REDIS_PROVIDER&quot;, &quot;127.0.0.1&quot;));
  configBuilder.withHostAndPort(redisUrl.getHost(), redisUrl.getPort());
  String redisUserInfo = redisUrl.getUserInfo();
  if (redisUserInfo != null) {
    configBuilder.withPassword(redisUserInfo.split(&quot;:&quot;, 2)[1]);
  }
} catch (URISyntaxException use) {
  // Handle error
}
final Config config = configBuilder.build();
</code></pre><hr /></section></section><section><a id="Design_Decisions"></a>
<h2>Design Decisions</h2>
<ul>

<li>I chose to implement the jobs as classes that implement <code>java.lang.Runnable</code> or <code>java.util.concurrent.Callable</code>. If the job requires arguments (most do), there must be a constructor that matches the supplied arguments. I felt this was the most flexible option and didn't require the jobs to inherit or implement a special Jesque class. Because of this, the jobs don't even need to know about Jesque at all. Furthermore, the client need not have the job's <code>Class</code> in its VM, it only needs to know the classname and all the parameters' <code>Class</code>es on its classpath. Only the workers realize the job and then run them.</li>
<li>I chose to use Jedis because:
<ol style="list-style-type: decimal;">

<li>It is simple to use</li>
<li>Fully supports Redis 2.0 and uses the new unified protocol</li>
<li>No dependencies</li>
</ol></li>
<li>I chose to use Jackson because:
<ol style="list-style-type: decimal;">

<li>I was already familiar with it</li>
<li>It performs great and does what it says on the tin</li>
<li>No dependencies</li>
</ol></li>
<li>I chose to use SLF4J because:
<ol style="list-style-type: decimal;">

<li>It lets the application choose how to log</li>
<li>No dependencies</li>
</ol></li>
</ul><hr /></section><section><a id="Misc."></a>
<h2>Misc.</h2>
<p>If you are on Mac OS X, I highly recommend using the fantasic <a href="https://brew.sh" class="externalLink">Homebrew package manager</a>. It makes installing and maintaining libraries, tools and applications a cinch. E.g.:</p>

<pre><code class="language-bash">brew install redis
brew install git
brew install maven
</code></pre>
<p>Boom! Ready to go!</p><hr /></section><section><a id="License"></a>
<h2>License</h2>
<p>Copyright 2026 Greg Haines</p>
<p>Licensed under the Apache License, Version 2.0 (the &#x201c;License&#x201d;);
you may not use this file except in compliance with the License.
You may obtain a copy of the License at</p>
<p><a href="http://www.apache.org/licenses/LICENSE-2.0" class="externalLink">http://www.apache.org/licenses/LICENSE-2.0</a></p>
<p>Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an &#x201c;AS IS&#x201d; BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.</p></section></section>
        </div>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>Copyright &copy;2011&#x2013;${currentYear}.
All rights reserved.</p>
        </div>
        </div>
    </footer>
    </body>
</html>